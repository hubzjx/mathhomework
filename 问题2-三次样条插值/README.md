# 问题2：三次样条插值 - 船舶吃水深度曲线

## 一、摘要（问题描述）

在船舶航行过程中，通过测量不同位置的吃水深度，可以了解船舶的负载情况以及在水中的姿态。然而，测量得到的数据往往是离散的，为了更精确地分析船舶吃水深度在整个船长方向上的变化规律，需要使用插值方法构建连续的吃水深度曲线。三次样条插值算法因其能够在保证曲线光滑性的同时较好地拟合数据，被广泛应用于此类问题的求解。

### 已知条件

假设我们在一艘长度为100米的船舶上，沿船长方向选取了6个测量点：

- 位置：$x = [0, 20, 40, 60, 80, 100]$ 米
- 吃水深度：$y = [5.0, 5.5, 6.2, 5.8, 5.3, 5.0]$ 米

## 二、数学原理

### 2.1 三次样条插值定义

给定$n+1$个数据点$(x_i, y_i)$，$i=0,1,...,n$，三次样条插值函数$S(x)$满足：

1. 在每个子区间$[x_i, x_{i+1}]$上，$S(x)$是三次多项式
2. $S(x_i) = y_i$，即插值函数通过所有数据点
3. $S(x)$在整个区间上具有连续的一阶和二阶导数
4. 边界条件（自然边界条件）：$S''(x_0) = S''(x_n) = 0$

### 2.2 三次样条函数形式

在区间$[x_i, x_{i+1}]$上，三次样条函数可表示为：

$$S_i(x) = a_i + b_i(x-x_i) + c_i(x-x_i)^2 + d_i(x-x_i)^3$$

其中系数$a_i, b_i, c_i, d_i$需要通过求解线性方程组得到。

### 2.3 求解方法

设$M_i = S''(x_i)$为节点处的二阶导数值，则：

1. 在区间$[x_i, x_{i+1}]$上：
   $$S_i(x) = M_i\frac{(x_{i+1}-x)^3}{6h_i} + M_{i+1}\frac{(x-x_i)^3}{6h_i} + \left(y_i - \frac{M_ih_i^2}{6}\right)\frac{x_{i+1}-x}{h_i} + \left(y_{i+1} - \frac{M_{i+1}h_i^2}{6}\right)\frac{x-x_i}{h_i}$$
   
   其中$h_i = x_{i+1} - x_i$

2. 连续性条件给出三对角方程组：
   $$\mu_i M_{i-1} + 2M_i + \lambda_i M_{i+1} = d_i$$
   
   其中：
   - $\mu_i = \frac{h_{i-1}}{h_{i-1}+h_i}$
   - $\lambda_i = \frac{h_i}{h_{i-1}+h_i}$
   - $d_i = 6f[x_{i-1},x_i,x_{i+1}]$

3. 自然边界条件：$M_0 = M_n = 0$

## 三、程序设计

### 3.1 输入变量说明

- `x`: 测量点位置数组（米）
- `y`: 对应的吃水深度数组（米）
- `x_new`: 需要插值的新位置数组（可选）

### 3.2 输出变量说明

- `M`: 各节点处的二阶导数值数组
- `coefficients`: 各区间的样条系数$(a_i, b_i, c_i, d_i)$
- `y_interp`: 插值结果数组
- `error`: 插值误差（在原始测量点处）

### 3.3 主要函数说明

- `cubic_spline_coefficients(x, y)`: 计算三次样条系数
- `cubic_spline_interpolate(x, y, x_new)`: 执行插值计算
- `plot_spline(x, y, x_new, y_new)`: 绘制插值曲线
- `calculate_error(x, y, S)`: 计算插值误差

## 四、结果分析

### 4.1 插值结果

通过三次样条插值，我们得到了一条光滑的吃水深度曲线，该曲线：
- 精确通过所有6个测量点
- 在整个区间上连续且光滑（具有连续的一阶和二阶导数）
- 能够清晰地展示吃水深度随船长方向的变化趋势

### 4.2 误差分析

在原始测量点处，插值误差理论上为零（插值函数精确通过这些点）。实际计算中由于数值误差，误差量级约为$10^{-14}$，可以忽略不计。

主要误差来源：
1. **测量误差**：原始数据本身可能存在测量误差
2. **模型误差**：实际船舶吃水深度曲线可能不是三次多项式
3. **舍入误差**：计算过程中的数值舍入

### 4.3 算法优缺点

**优点：**
1. 插值曲线通过所有数据点，保持数据的真实性
2. 曲线光滑，具有连续的二阶导数，符合物理实际
3. 计算效率高，只需求解三对角方程组
4. 数值稳定性好

**缺点：**
1. 对异常点敏感，一个错误的测量值会影响整条曲线
2. 在端点附近可能出现较大的振荡（Runge现象）
3. 不能外推到测量范围之外

### 4.4 局部调整方案

当吃水深度在区间$[40, 60]$米增加0.2米时：

**方案1：局部重新计算**
- 只需重新计算受影响区间的样条系数
- 受影响的区间通常包括变化区间及其相邻区间
- 这种方法比完全重新计算快得多

**方案2：增量更新**
- 利用样条函数的局部性质
- 只更新三对角方程组中相关的行
- 通过追赶法求解更新后的方程组

局部调整的影响：
- 主要影响区间$[20, 80]$米
- 对两端影响较小，体现了样条函数的局部支撑性
- 调整后的曲线仍保持光滑性

## 五、完成题目的体会与收获

通过本题的学习和实践，我获得了以下收获：

1. **理论理解**：深入理解了三次样条插值的数学原理，特别是连续性条件和边界条件的作用

2. **算法实现**：掌握了三次样条插值的编程实现，包括求解三对角方程组的追赶法

3. **工程应用**：认识到插值方法在工程实际中的重要性，特别是在数据处理和曲线拟合方面

4. **数值分析能力**：学会了分析插值误差，理解算法的优缺点，并能提出改进方案

5. **问题解决思维**：面对局部调整问题，学会利用算法的特性（如局部性）提高计算效率

6. **可视化技能**：通过绘图直观展示结果，增强了对数据的理解和分析能力

这次作业让我认识到，数值计算方法不仅是数学工具，更是解决实际工程问题的重要手段。在应用中需要综合考虑精度、效率和稳定性等多个因素。
